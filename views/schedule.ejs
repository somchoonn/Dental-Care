<%- include('partials/head', { title: title }) %>
<section class="wrap">
  <div class="brand">
    <div class="logo">ü¶∑</div>
    <div>
      <h1>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢</h1>
      <p>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏Ñ‡∏¥‡∏ß‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡∏∞‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤</p>
    </div>
  </div>

  <div class="card">
    <div class="grid-2">
      <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
        <input type="date" id="dateFilter" oninput="filterAppt()" />
      </label>
      <label>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ (‡∏ä‡∏∑‡πà‡∏≠/‡∏´‡∏°‡∏≠/‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•)
        <input id="txtFilter" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏á" oninput="filterAppt()" />
      </label>
    </div>

    <div style="overflow:auto; margin-top:12px;">
      <table style="width:100%; border-collapse:separate; border-spacing:0 8px;">
        <thead>
          <tr>
            <th style="text-align:left; padding:8px;">‡πÄ‡∏ß‡∏•‡∏≤</th>
            <th style="text-align:left; padding:8px;">‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</th>
            <th style="text-align:left; padding:8px;">‡∏ó‡∏±‡∏ô‡∏ï‡πÅ‡∏û‡∏ó‡∏¢‡πå</th>
            <th style="text-align:left; padding:8px;">‡∏´‡πâ‡∏≠‡∏á</th>
            <th style="text-align:left; padding:8px;">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</th>
          </tr>
        </thead>
        <tbody id="ap-body">
          <% rows.forEach(r => { %>
            <tr data-date="<%= r.date %>" data-text="<%= (r.patient.titleName + r.patient.firstName + ' ' + r.patient.lastName + ' ' + r.dentist + ' ' + r.reason).toLowerCase() %>"
                style="background:#fbfbff;">
              <td style="padding:10px 8px;"><%= r.date %> <%= r.time %></td>
              <td style="padding:10px 8px;"><%= r.patient.titleName %><%= r.patient.firstName %> <%= r.patient.lastName %></td>
              <td style="padding:10px 8px;"><%= r.dentist %></td>
              <td style="padding:10px 8px;"><%= r.room %></td>
              <td style="padding:10px 8px;"><%= r.reason %></td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  </div>
</section>

<script>
function filterAppt(){
  const d = document.getElementById('dateFilter').value;
  const t = (document.getElementById('txtFilter').value || '').toLowerCase();
  document.querySelectorAll('#ap-body tr').forEach(tr=>{
    const okDate = !d || tr.dataset.date === d;
    const okText = !t || tr.dataset.text.includes(t);
    tr.style.display = (okDate && okText) ? '' : 'none';
  });
}
</script>
<%- include('partials/foot') %>
